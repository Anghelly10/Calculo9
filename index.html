<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Desigualdades con Gráfica</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f0f0f0;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      margin-top: 10px;
    }
    #resultado {
      margin-top: 20px;
      padding: 15px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 5px #999;
    }
    #grafico {
      margin-top: 30px;
    }
  </style>
</head>
<body>

  <h2>Resolver Desigualdades con Gráfica</h2>
  <input id="input" placeholder="Ej: x^2 - 4 < 0 o 2x - 3 >= 5">
  <button onclick="resolver()">Resolver</button>

  <div id="resultado"></div>
  <div id="grafico"></div>

  <script>
    function resolver() {
      const input = document.getElementById("input").value;
      const resultado = document.getElementById("resultado");
      const grafico = document.getElementById("grafico");
      resultado.innerHTML = "";
      grafico.innerHTML = "";

      const match = input.match(/(.+)(<=|>=|<|>)(.+)/);
      if (!match) {
        resultado.innerHTML = "⚠️ Formato incorrecto. Usa formato como: x^2 - 4 < 0";
        return;
      }

      let izquierda = match[1].trim();
      const signo = match[2];
      const derecha = match[3].trim();

      // Pasamos todo al lado izquierdo: izquierda - derecha
      const expresion = `${izquierda} - (${derecha})`.replace(/\^/g, "**");

      // Creamos valores de X y evaluamos Y
      let x = [], y = [];
      for (let i = -20; i <= 20; i += 0.1) {
        x.push(i);
        try {
          let val = eval(expresion.replace(/x/g, `(${i})`));
          y.push(val);
        } catch {
          y.push(null);
        }
      }

      // Mostramos pasos básicos
      resultado.innerHTML = `
        <b>Desigualdad:</b> ${input}<br>
        <b>Forma transformada:</b> ${izquierda} - (${derecha}) ${signo} 0<br>
        <b>Gráfica de f(x):</b> Ver abajo<br><br>
        Observa dónde la curva está ${signo === "<" ? "debajo" : signo === ">" ? "encima" : signo === "<=" ? "debajo o en" : "encima o en"} del eje X (y = 0).
      `;

      // Graficar con Plotly
      const datos = [
        {
          x: x,
          y: y,
          type: 'scatter',
          mode: 'lines',
          name: 'f(x)',
          line: {color: 'blue'}
        },
        {
          x: x,
          y: Array(x.length).fill(0),
          type: 'scatter',
          mode: 'lines',
          name: 'y = 0',
          line: {color: 'red', dash: 'dash'}
        }
      ];

      const layout = {
        title: 'Gráfico de la Desigualdad',
        xaxis: {title: 'x'},
        yaxis: {title: 'f(x)'},
        margin: {t: 40}
      };

      Plotly.newPlot('grafico', datos, layout);
    }
  </script>
</body>
</html>
